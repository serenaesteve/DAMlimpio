El objetivo de este proyecto es desarrollar una tienda online de productos para animales aplicando los conocimientos aprendidos en clase sobre PHP y bases de datos. A partir de un cÃ³digo base proporcionado, he ampliado y mejorado la aplicaciÃ³n para que tenga un funcionamiento mÃ¡s completo y una estructura mÃ¡s ordenada, simulando el comportamiento de una tienda online real.


Base de datos:
```
serena@serena-portatil:~$ sudo mysql
[sudo] contraseÃ±a para serena: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 10
Server version: 8.0.45-0ubuntu0.24.04.1 (Ubuntu)

Copyright (c) 2000, 2026, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> CREATE DATABASE IF NOT EXISTS petshop
    ->   CHARACTER SET utf8mb4
    ->   COLLATE utf8mb4_unicode_ci;
Query OK, 1 row affected (0,00 sec)

mysql> 
mysql> USE petshop;CREATE TABLE categoria (
Database changed
    ->   id INT AUTO_INCREMENT PRIMARY KEY,
    ->   nombre VARCHAR(80) NOT NULL,
    ->   slug VARCHAR(90) NOT NULL UNIQUE
    -> ) ENGINE=InnoDB;
Query OK, 0 rows affected (0,03 sec)

mysql> 
mysql> CREATE TABLE producto (
    ->   id INT AUTO_INCREMENT PRIMARY KEY,
    ->   categoria_id INT NOT NULL,
    ->   titulo VARCHAR(120) NOT NULL,
    ->   descripcion TEXT NOT NULL,
    ->   precio DECIMAL(10,2) NOT NULL,
    ->   stock INT NOT NULL DEFAULT 0,
    ->   imagen VARCHAR(255) NULL,
    ->   destacado TINYINT(1) NOT NULL DEFAULT 0,
    ->   creado_en TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    ->   CONSTRAINT fk_producto_categoria
    ->     FOREIGN KEY (categoria_id) REFERENCES categoria(id)
    ->     ON UPDATE CASCADE
    ->     ON DELETE RESTRICT,
    ->   INDEX idx_producto_categoria (categoria_id),
    ->   INDEX idx_producto_destacado (destacado)
    -> ) ENGINE=InnoDB;
Query OK, 0 rows affected, 1 warning (0,03 sec)

mysql> 
mysql> CREATE TABLE cliente (
    ->   id INT AUTO_INCREMENT PRIMARY KEY,
    ->   nombre VARCHAR(80) NOT NULL,
    ->   apellidos VARCHAR(120) NOT NULL,
    ->   email VARCHAR(180) NOT NULL UNIQUE,
    ->   telefono VARCHAR(30) NULL,
    ->   direccion VARCHAR(200) NOT NULL,
    ->   ciudad VARCHAR(80) NOT NULL,
    ->   provincia VARCHAR(80) NOT NULL,
    ->   cp VARCHAR(12) NOT NULL,
    ->   creado_en TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
    -> ) ENGINE=InnoDB;
Query OK, 0 rows affected (0,02 sec)

mysql> 
mysql> CREATE TABLE pedido (
    ->   id INT AUTO_INCREMENT PRIMARY KEY,
    ->   cliente_id INT NOT NULL,
    ->   fecha TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    ->   estado ENUM('pendiente','pagado','enviado','cancelado') NOT NULL DEFAULT 'pendiente',
    ->   total DECIMAL(10,2) NOT NULL DEFAULT 0.00,
    ->   notas VARCHAR(255) NULL,
    ->   CONSTRAINT fk_pedido_cliente
    ->     FOREIGN KEY (cliente_id) REFERENCES cliente(id)
    ->     ON UPDATE CASCADE
    ->     ON DELETE RESTRICT,
    ->   INDEX idx_pedido_cliente (cliente_id),
    ->   INDEX idx_pedido_fecha (fecha)
    -> ) ENGINE=InnoDB;
Query OK, 0 rows affected (0,02 sec)

mysql> 
mysql> CREATE TABLE linea_pedido (
    ->   id INT AUTO_INCREMENT PRIMARY KEY,
    ->   pedido_id INT NOT NULL,
    ->   producto_id INT NOT NULL,
    ->   cantidad INT NOT NULL,
    ->   precio_unitario DECIMAL(10,2) NOT NULL,
    ->   subtotal DECIMAL(10,2) NOT NULL,
    ->   CONSTRAINT fk_linea_pedido
    ->     FOREIGN KEY (pedido_id) REFERENCES pedido(id)
    ->     ON UPDATE CASCADE
    ->     ON DELETE CASCADE,
    ->   CONSTRAINT fk_linea_producto
    ->     FOREIGN KEY (producto_id) REFERENCES producto(id)
    ->     ON UPDATE CASCADE
    ->     ON DELETE RESTRICT,
    ->   INDEX idx_linea_pedido (pedido_id),
    ->   INDEX idx_linea_producto (producto_id)
    -> ) ENGINE=InnoDB;
Query OK, 0 rows affected (0,03 sec)

mysql> INSERT INTO categoria (nombre, slug) VALUES
    -> ('Perros', 'perros'),
    -> ('Gatos', 'gatos'),
    -> ('Aves', 'aves'),
    -> ('Acuario', 'acuario');
Query OK, 4 rows affected (0,02 sec)
Records: 4  Duplicates: 0  Warnings: 0

mysql> 
mysql> INSERT INTO producto (categoria_id, titulo, descripcion, precio, stock, imagen, destacado) VALUES
    -> (1,'Pienso premium cachorro','Pienso completo con pollo y arroz para cachorros. Bolsa 3kg.', 18.95, 25, NULL, 1),
    -> (1,'ArnÃ©s ajustable','ArnÃ©s transpirable con agarre seguro. Talla M.', 12.50, 40, NULL, 1),
    -> (1,'Juguete mordedor','Mordedor de goma resistente para perros medianos.', 6.90, 60, NULL, 0),
    -> (2,'Arena aglomerante 10L','Arena de alta absorciÃ³n y control de olores.', 9.99, 30, NULL, 1),
    -> (2,'Rascador compacto','Rascador de sisal con base antideslizante.', 15.75, 12, NULL, 0),
    -> (2,'Snack dental','Premios para ayudar a la higiene dental (60g).', 3.40, 80, NULL, 0),
    -> (3,'Mezcla semillas','Mezcla equilibrada para canarios (1kg).', 4.95, 50, NULL, 0),
    -> (3,'Juguete colgante','Juguete con campana para jaula.', 2.95, 70, NULL, 0),
    -> (4,'Comida para peces','Escamas multivitamÃ­nicas (250ml).', 5.50, 45, NULL, 1),
    -> (4,'Filtro interno','Filtro interno para acuarios hasta 60L.', 19.90, 10, NULL, 0);
Query OK, 10 rows affected (0,00 sec)
Records: 10  Duplicates: 0  Warnings: 0

mysql> 

atos/petshop$ sudo mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 12
Server version: 8.0.45-0ubuntu0.24.04.1 (Ubuntu)

Copyright (c) 2000, 2026, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> CREATE USER IF NOT EXISTS 'petshopuser'@'localhost' IDENTIFIED BY 'petshoppass';
Query OK, 0 rows affected (0,01 sec)

mysql> GRANT ALL PRIVILEGES ON petshop.* TO 'petshopuser'@'localhost';
Query OK, 0 rows affected (0,00 sec)

mysql> FLUSH PRIVILEGES;
Query OK, 0 rows affected (0,00 sec)

mysql> EXIT;
Bye
serena@serena-portatil:/var/www/html/DAMlimpio/proyectosfinaldeunidad/bases de datos/petshop$ 

serena@serena-portatil:/var/www/html/DAMlimpio/proyectosfinaldeunidad/bases de datos/petshop$ sudo mysql
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 27
Server version: 8.0.45-0ubuntu0.24.04.1 (Ubuntu)

Copyright (c) 2000, 2026, Oracle and/or its affiliates.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql> USE petshop;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql> UPDATE producto SET imagen = 'public/img/productos/pienso-cachorro.jpg' WHERE id = 1;
Query OK, 1 row affected (0,01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/arnes-ajustable.jpg' WHERE id = 2;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/mordedor-perro.jpg' WHERE id = 3;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/arena-gatos-10l.jpg' WHERE id = 4;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/rascador-gato.jpg' WHERE id = 5;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/snack-dental.jpg' WHERE id = 6;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/semillas-aves.jpg' WHERE id = 7;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/juguete-aves.jpg' WHERE id = 8;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/comida-peces.jpg' WHERE id = 9;
Query OK, 1 row affected (0,01 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> UPDATE producto SET imagen = 'public/img/productos/filtro-acuario.jpg' WHERE id = 10;
Query OK, 1 row affected (0,00 sec)
Rows matched: 1  Changed: 1  Warnings: 0

mysql> SELECT id, titulo, imagen FROM producto;
+----+-------------------------+------------------------------------------+
| id | titulo                  | imagen                                   |
+----+-------------------------+------------------------------------------+
|  1 | Pienso premium cachorro | public/img/productos/pienso-cachorro.jpg |
|  2 | ArnÃ©s ajustable         | public/img/productos/arnes-ajustable.jpg |
|  3 | Juguete mordedor        | public/img/productos/mordedor-perro.jpg  |
|  4 | Arena aglomerante 10L   | public/img/productos/arena-gatos-10l.jpg |
|  5 | Rascador compacto       | public/img/productos/rascador-gato.jpg   |
|  6 | Snack dental            | public/img/productos/snack-dental.jpg    |
|  7 | Mezcla semillas         | public/img/productos/semillas-aves.jpg   |
|  8 | Juguete colgante        | public/img/productos/juguete-aves.jpg    |
|  9 | Comida para peces       | public/img/productos/comida-peces.jpg    |
| 10 | Filtro interno          | public/img/productos/filtro-acuario.jpg  |
+----+-------------------------+------------------------------------------+
10 rows in set (0,00 sec)

mysql> exit;
Bye
serena@serena-portatil:/var/www/html/DAMlimpio/proyectosfinaldeunidad/bases de datos/petshop$ 
```


acciones_carrito.php:
```
<?php
require_once "inc/bootstrap.php";

if ($_SERVER['REQUEST_METHOD'] !== 'POST') {
  header("Location: carrito.php");
  exit;
}

csrf_check();
cart_init();

$accion = $_POST['accion'] ?? 'add';
$id = (int)($_POST['id'] ?? 0);
$qty = (int)($_POST['qty'] ?? 1);

if ($accion === 'clear') {
  cart_clear();
  flash_set("Carrito vaciado");
  header("Location: carrito.php");
  exit;
}

if ($id <= 0) {
  flash_set("Producto invÃ¡lido", "bad");
  header("Location: index.php");
  exit;
}

$actual = (int)($_SESSION['cart'][$id] ?? 0);

switch ($accion) {
  case 'add':
    if ($qty < 1) $qty = 1;
    $_SESSION['cart'][$id] = $actual + $qty;
    break;

  case 'inc':
    $_SESSION['cart'][$id] = $actual + 1;
    break;

  case 'dec':
    $nuevo = $actual - 1;
    if ($nuevo <= 0) unset($_SESSION['cart'][$id]);
    else $_SESSION['cart'][$id] = $nuevo;
    break;

  case 'set':
    if ($qty <= 0) unset($_SESSION['cart'][$id]);
    else $_SESSION['cart'][$id] = $qty;
    break;

  case 'remove':
    unset($_SESSION['cart'][$id]);
    break;
}

header("Location: " . ($_SERVER['HTTP_REFERER'] ?? "carrito.php"));
exit;
```

carrito.php:
```
<?php
require_once "inc/repos.php";
cart_init();
require_once "header.php";
?>
<h2>Carrito</h2>
<ul>
<?php foreach($_SESSION['cart'] as $id=>$qty): ?>
  <li>Producto <?= $id ?> x <?= $qty ?></li>
<?php endforeach; ?>
</ul>
<a href="checkout.php">Finalizar compra</a>
<?php require_once "footer.php"; ?>
```


catalogo.php:
```
<?php
require_once "header.php";
require_once "inc/repos.php";

$q = $_GET['q'] ?? null;
$cat = isset($_GET['cat']) ? (int)$_GET['cat'] : null;

$cats = categorias();
$productos = productos($q, $cat);
?>

<main class="container">

  <div class="card pad" style="margin:16px 0">
    <h2 style="margin:0 0 10px 0">CatÃ¡logo</h2>

    <form method="get" action="catalogo.php" style="display:flex; gap:10px; flex-wrap:wrap; align-items:end">
      <div>
        <label class="muted">Buscar</label><br>
        <input type="text" name="q" value="<?= h((string)$q) ?>" placeholder="pienso, juguetes..." />
      </div>

      <div>
        <label class="muted">CategorÃ­a</label><br>
        <select name="cat">
          <option value="">Todas</option>
          <?php foreach ($cats as $c): ?>
            <option value="<?= (int)$c['id'] ?>" <?= ($cat === (int)$c['id']) ? 'selected' : '' ?>>
              <?= h($c['nombre']) ?>
            </option>
          <?php endforeach; ?>
        </select>
      </div>

      <button class="btn primary" type="submit">Filtrar</button>
      <a class="btn" href="catalogo.php">Quitar filtros</a>
    </form>
  </div>

  <section class="grid">
    <?php foreach($productos as $p): ?>
      <?php include "inc/product_card.php"; ?>
    <?php endforeach; ?>
  </section>

</main>

<?php require_once "footer.php"; ?>
```


checkout.php:
```
<?php
require_once "inc/bootstrap.php";
require_once "header.php";
?>
<h2>Finalizar compra</h2>
<form action="confirmar.php" method="post">
  <input type="hidden" name="csrf" value="<?= $_SESSION['csrf'] ?>">
  <input name="nombre" placeholder="Nombre" required>
  <input name="email" placeholder="Email" required>
  <button>Confirmar</button>
</form>
<?php require_once "footer.php"; ?>
```


confirmar.php:
```
<?php
require_once "inc/bootstrap.php";
csrf_check();
cart_clear();
flash_set("Pedido realizado correctamente");
header("Location: gracias.php");
```


footer.php:
```
</main>

<footer class="site-footer">
  <div class="container footer-inner">
    <p>Â© <?= date('Y') ?> PetShop. Hecho con PHP + MySQL.</p>
    <p class="muted">Proyecto educativo (DAM). Sin pasarela real: el pago es simulado.</p>
  </div>
</footer>
</body>
</html>
```

gracias.php:
```
<?php
require_once "inc/bootstrap.php";
require_once "header.php";
?>
<h2>Gracias por tu compra</h2>
<p>Tu pedido ha sido registrado correctamente.</p>
<a href="index.php">Volver a la tienda</a>
<?php require_once "footer.php"; ?>
```


header.php:
```
<?php
declare(strict_types=1);
require_once __DIR__ . "/inc/bootstrap.php";
$flash = flash_get();
cart_init();
$cartCount = array_sum($_SESSION['cart']);
?>
<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title><?= h(APP_NAME) ?></title>
  <link rel="stylesheet" href="<?= h(base_url('public/estilo.css')) ?>">
</head>
<body>
<header class="site-header">
  <div class="container header-inner">
    <a class="brand" href="<?= h(base_url('index.php')) ?>">
      <span class="logo">ğŸ¾</span>
      <span><?= h(APP_NAME) ?></span>
    </a>

    <form class="search" action="<?= h(base_url('catalogo.php')) ?>" method="get">
      <input type="search" name="q" placeholder="Buscar pienso, juguetes, arneses..." value="<?= h($_GET['q'] ?? '') ?>">
      <button type="submit">Buscar</button>
    </form>

    <nav class="nav">
      <a href="<?= h(base_url('catalogo.php')) ?>">CatÃ¡logo</a>
      <a class="cart-link" href="<?= h(base_url('carrito.php')) ?>">Carrito <span class="badge"><?= (int)$cartCount ?></span></a>
    </nav>
  </div>
</header>

<main class="container">
<?php if ($flash): ?>
  <div class="flash <?= h($flash['type']) ?>"><?= h($flash['msg']) ?></div>
<?php endif; ?>
```


index.php:
```
<?php
require_once "header.php";
require_once "inc/repos.php";

$productos = productos($_GET['q'] ?? '');
?>

<main class="container">

  <?php if ($flash): ?>
    <div class="flash"><?= h($flash['msg']) ?></div>
  <?php endif; ?>

  <!-- CAMBIO AQUÃ: catalogo â†’ grid -->
  <section class="grid">
    <?php foreach($productos as $p): ?>
      <?php include "inc/product_card.php"; ?>
    <?php endforeach; ?>
  </section>

</main>

<?php require_once "footer.php"; ?>
```


producto.php:
```
<?php
require_once "inc/repos.php";
$id = (int)($_GET['id'] ?? 0);
$p = producto_por_id($id);
require_once "header.php";
?>
<section class="producto">
  <h2><?= h($p['titulo']) ?></h2>
  <p><?= h($p['descripcion']) ?></p>
  <p><?= money($p['precio']) ?></p>
  <form action="acciones_carrito.php" method="post">
    <input type="hidden" name="csrf" value="<?= $_SESSION['csrf'] ?>">
    <input type="hidden" name="id" value="<?= $p['id'] ?>">
    <button>AÃ±adir al carrito</button>
  </form>
</section>
<?php require_once "footer.php"; ?>
```


config.php:
```
<?php
declare(strict_types=1);

define('DB_HOST', '127.0.0.1');
define('DB_NAME', 'petshop');
define('DB_USER', 'petshopuser');
define('DB_PASS', 'petshoppass');
define('DB_CHARSET', 'utf8mb4');

define('BASE_URL', '');
define('APP_NAME', 'PetShop - Tienda para animales');

ini_set('display_errors', '1');
error_reporting(E_ALL);
```



db.php:
```
<?php
declare(strict_types=1);

require_once __DIR__ . '/config.php';

function db(): PDO {
    static $pdo = null;
    if ($pdo instanceof PDO) return $pdo;

    $dsn = 'mysql:host=' . DB_HOST . ';dbname=' . DB_NAME . ';charset=' . DB_CHARSET;

    $pdo = new PDO($dsn, DB_USER, DB_PASS, [
        PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,
        PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,
    ]);

    return $pdo;
}
```



bootstrap.php:
```
<?php
declare(strict_types=1);

require_once __DIR__ . '/../config/db.php';
require_once __DIR__ . '/../config/config.php';

if (session_status() === PHP_SESSION_NONE) {
    session_start();
}

if (!isset($_SESSION['csrf'])) {
    $_SESSION['csrf'] = bin2hex(random_bytes(16));
}

function h(string $s): string {
    return htmlspecialchars($s, ENT_QUOTES | ENT_SUBSTITUTE, 'UTF-8');
}

function money(float $n): string {
    return number_format($n, 2, ',', '.') . ' â‚¬';
}

function base_url(string $path = ''): string {
    // Si BASE_URL estÃ¡ vacÃ­o, devuelve rutas relativas
    $base = rtrim((string)BASE_URL, '/');
    $path = ltrim($path, '/');
    return ($base === '') ? $path : $base . '/' . $path;
}

/* ===== Flash messages ===== */
function flash_set(string $msg, string $type='ok'): void {
    $_SESSION['flash'] = ['msg' => $msg, 'type' => $type];
}
function flash_get(): ?array {
    if (!isset($_SESSION['flash'])) return null;
    $f = $_SESSION['flash'];
    unset($_SESSION['flash']);
    return $f;
}

/* ===== Carrito ===== */
function cart_init(): void {
    if (!isset($_SESSION['cart']) || !is_array($_SESSION['cart'])) {
        $_SESSION['cart'] = [];
    }
}
function cart_add(int $id, int $qty = 1): void {
    cart_init();
    if ($qty < 1) $qty = 1;
    $_SESSION['cart'][$id] = ($_SESSION['cart'][$id] ?? 0) + $qty;
}
function cart_clear(): void {
    $_SESSION['cart'] = [];
}

/* ===== CSRF ===== */
function csrf_check(): void {
    $t = $_POST['csrf'] ?? '';
    if (!hash_equals($_SESSION['csrf'] ?? '', (string)$t)) {
        http_response_code(400);
        exit('CSRF invÃ¡lido');
    }
}
```

product_card.php:
```
<?php
cart_init();

$img = trim((string)($p['imagen'] ?? ''));
$placeholder = 'public/img/productos/placeholder.jpg';

// comprobamos en disco (ruta fÃ­sica)
$img_fs = __DIR__ . '/../' . ($img !== '' ? $img : $placeholder);
if ($img === '' || !is_file($img_fs)) {
  $img = $placeholder;
}

$enCarrito = (int)($_SESSION['cart'][(int)$p['id']] ?? 0);
?>

<article class="product">
  <a class="imgwrap" href="<?= h(base_url('producto.php?id='.(int)$p['id'])) ?>">
    <img class="img"
         src="<?= h(base_url($img)) ?>"
         alt="<?= h($p['titulo']) ?>">
  </a>

  <div class="body">
    <div class="muted"><?= h($p['categoria'] ?? '') ?></div>
    <p class="title"><?= h($p['titulo']) ?></p>

    <div class="muted">
      <?= h(mb_strimwidth((string)$p['descripcion'], 0, 70, 'â€¦', 'UTF-8')) ?>
    </div>

    <div class="row">
      <span class="price"><?= h(money((float)$p['precio'])) ?></span>
      <span class="muted">En carrito: <?= $enCarrito ?></span>
    </div>

    <div class="qtybar">
      <form action="acciones_carrito.php" method="post">
        <input type="hidden" name="csrf" value="<?= h($_SESSION['csrf']) ?>">
        <input type="hidden" name="accion" value="dec">
        <input type="hidden" name="id" value="<?= (int)$p['id'] ?>">
        <button class="btn">âˆ’</button>
      </form>

      <div class="qty"><?= $enCarrito ?></div>

      <form action="acciones_carrito.php" method="post">
        <input type="hidden" name="csrf" value="<?= h($_SESSION['csrf']) ?>">
        <input type="hidden" name="accion" value="inc">
        <input type="hidden" name="id" value="<?= (int)$p['id'] ?>">
        <button class="btn">+</button>
      </form>
    </div>
  </div>
</article>
```


repos.php:
```
<?php
require_once __DIR__ . '/bootstrap.php';

function categorias(): array {
    return db()->query("SELECT * FROM categoria ORDER BY nombre")->fetchAll();
}

function productos(?string $q = null, ?int $cat = null): array {
    $sql = "
        SELECT p.*, c.nombre AS categoria
        FROM producto p
        JOIN categoria c ON c.id = p.categoria_id
        WHERE 1=1
    ";
    $params = [];

    if ($q !== null && trim($q) !== '') {
        $sql .= " AND (p.titulo LIKE ? OR p.descripcion LIKE ?)";
        $like = '%' . trim($q) . '%';
        $params[] = $like;
        $params[] = $like;
    }

    if ($cat !== null && $cat > 0) {
        $sql .= " AND p.categoria_id = ?";
        $params[] = $cat;
    }

    $sql .= " ORDER BY p.id DESC";

    $st = db()->prepare($sql);
    $st->execute($params);
    return $st->fetchAll();
}

function producto_por_id(int $id) {
    $st = db()->prepare("
        SELECT p.*, c.nombre AS categoria
        FROM producto p
        JOIN categoria c ON c.id = p.categoria_id
        WHERE p.id = ?
    ");
    $st->execute([$id]);
    return $st->fetch();
}
```


estilo.css:
```
:root{
  --bg:#f6f7fb;
  --card:#ffffff;
  --text:#1f2937;
  --muted:#6b7280;
  --accent:#ff7a00;
  --stroke:#e5e7eb;
  --shadow: 0 8px 20px rgba(17,24,39,.08);
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background: var(--bg);
  color: var(--text);
}

a{color:inherit;text-decoration:none}

.container{
  width:min(1100px, 92vw);
  margin:0 auto;
}


.site-header{
  background:#ffffff;
  border-bottom:1px solid var(--stroke);
}

.header-inner{
  display:flex;
  align-items:center;
  gap:16px;
  padding:14px 0;
}

.brand{
  font-weight:900;
  font-size:20px;
}

.nav{
  display:flex;
  gap:12px;
  margin-left:auto;
}

.nav a{
  padding:8px 12px;
  border-radius:12px;
}

.nav a:hover{
  background:#f3f4f6;
}

.badge{
  display:inline-flex;
  min-width:22px;
  height:22px;
  align-items:center;
  justify-content:center;
  border-radius:999px;
  background:#fff3e6;
  border:1px solid #ffd9b3;
  font-size:12px;
}


.grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:14px;
}

@media (max-width: 900px){
  .grid{ grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 520px){
  .grid{ grid-template-columns: 1fr; }
}

.product{
  background: var(--card);
  border:1px solid var(--stroke);
  border-radius:14px;
  box-shadow: var(--shadow);
  overflow:hidden;
  display:flex;
  flex-direction:column;
  transition: transform .15s ease, box-shadow .15s ease;
}

.product:hover{
  transform: translateY(-3px);
  box-shadow: 0 14px 30px rgba(0,0,0,.12);
}

.product .img{
  height:130px;
  background:#eef2ff;
  background-size:cover;
  background-position:center;
}

.product .body{
  padding:10px;
  display:flex;
  flex-direction:column;
  gap:6px;
}

.product .title{
  font-size:14px;
  font-weight:800;
  margin:0;
}

.muted{
  color:var(--muted);
  font-size:12px;
}

.product .price{
  font-weight:900;
  margin-top:4px;
}

.product .actions{
  display:flex;
  gap:6px;
  margin-top:8px;
}

.btn{
  flex:1;
  text-align:center;
  padding:8px 10px;
  font-size:13px;
  font-weight:800;
  border-radius:10px;
  border:1px solid var(--stroke);
  background:#fff;
  cursor:pointer;
}

.btn.primary{
  background:var(--accent);
  color:#fff;
  border-color:transparent;
}

.table{
  width:100%;
  border-collapse: collapse;
  border-radius:14px;
  overflow:hidden;
  border:1px solid var(--stroke);
  background:#fff;
}

.table th,
.table td{
  padding:10px 12px;
  border-bottom:1px solid var(--stroke);
  text-align:left;
}

.table th{
  background:#f9fafb;
}

.table tr:last-child td{
  border-bottom:none;
}


.form{
  display:grid;
  gap:10px;
}

.form label{
  font-weight:800;
}

.form input,
.form textarea{
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--stroke);
  background:#fff;
}

.grid{
  display:grid;
  grid-template-columns: repeat(3, 1fr);
  gap:14px;
}

@media (max-width: 900px){
  .grid{ grid-template-columns: repeat(2, 1fr); }
}
@media (max-width: 520px){
  .grid{ grid-template-columns: 1fr; }
}


.product .img{ height:130px; }
.product .title{ font-size:14px; }
.product .body{ padding:10px; }
.btn{ padding:8px 10px; font-size:13px; }


.search{
  display:flex;
  align-items:center;
  gap:6px;
  flex:unset;
  max-width:none;
}

.search input{
  width:200px;
  padding:6px 8px;
  border-radius:6px;
  border:1px solid #ccc;
  font-size:14px;
}

.search button{
  padding:6px 10px;
  border-radius:6px;
  border:1px solid #ccc;
  background:#f3f3f3;
  color:#000;
  font-weight:normal;
  cursor:pointer;
}

.search button:hover{
  background:#e5e5e5;
}
.grid{ display:grid; grid-template-columns:repeat(3,1fr); gap:14px; }
@media (max-width:900px){ .grid{ grid-template-columns:repeat(2,1fr); } }
@media (max-width:520px){ .grid{ grid-template-columns:1fr; } }

.product{ background:#fff; border:1px solid #e5e7eb; border-radius:14px; overflow:hidden; }
.imgwrap{ display:block; }
.product .img{ width:100%; height:140px; object-fit:cover; display:block; }
.product .body{ padding:10px; }
.product .title{ margin:0; font-weight:800; font-size:14px; }
.product .row{ display:flex; justify-content:space-between; align-items:center; margin-top:8px; }

.qtybar{ display:flex; gap:8px; align-items:center; margin-top:10px; }
.qtybar form{ margin:0; }
.qty{ min-width:34px; text-align:center; font-weight:800; padding:8px 10px; border:1px solid #e5e7eb; border-radius:10px; background:#fff; }
```

petshop/
â”‚
â”œâ”€â”€ index.php
â”œâ”€â”€ catalogo.php
â”œâ”€â”€ producto.php
â”œâ”€â”€ carrito.php
â”œâ”€â”€ acciones_carrito.php
â”œâ”€â”€ checkout.php
â”œâ”€â”€ confirmar.php
â”œâ”€â”€ gracias.php
â”‚
â”œâ”€â”€ header.php
â”œâ”€â”€ footer.php
â”‚
â”œâ”€â”€ inc/
â”‚   â”œâ”€â”€ bootstrap.php
â”‚   â”œâ”€â”€ repos.php
â”‚   â””â”€â”€ product_card.php
â”‚
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ config.php
â”‚   â””â”€â”€ db.php
â”‚
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ estilo.css
â”‚   â””â”€â”€ img/
â”‚       â”œâ”€â”€ logo.png
â”‚       â”œâ”€â”€ perro.png
â”‚       â”œâ”€â”€ gato.png
â”‚       â”œâ”€â”€ ave.png
â”‚       â”œâ”€â”€ pez.png
â”‚       â””â”€â”€ productos/
â”‚           â”œâ”€â”€ arena-10l.jpg
â”‚           â”œâ”€â”€ arnes-ajustable.jpg
â”‚           â”œâ”€â”€ comida-peces.jpg
â”‚           â”œâ”€â”€ filtro-acuario.jpg
â”‚           â”œâ”€â”€ juguete-aves.jpg
â”‚           â”œâ”€â”€ mordedor.jpg
â”‚           â”œâ”€â”€ pienso-cachorro.jpg
â”‚           â”œâ”€â”€ rascador.jpg
â”‚           â”œâ”€â”€ semillas.jpg
â”‚           â”œâ”€â”€ snack-dental.jpg
â”‚           â””â”€â”€ placeholder.jpg
â”‚



En este proyecto he desarrollado una tienda online de productos para animales partiendo del cÃ³digo base realizado en clase. A partir de ese cÃ³digo inicial he realizado varias mejoras tanto a nivel de organizaciÃ³n como de funcionalidad y diseÃ±o para que la aplicaciÃ³n sea mÃ¡s completa y realista.

En primer lugar, he reorganizado el proyecto separando los archivos en distintas carpetas para mantener el cÃ³digo ordenado y mÃ¡s seguro. He separado la configuraciÃ³n y la conexiÃ³n a la base de datos, la lÃ³gica del proyecto y los archivos pÃºblicos como estilos e imÃ¡genes. Esto facilita el mantenimiento del cÃ³digo y evita errores.

He creado y utilizado una base de datos MySQL donde se almacenan los productos con su nombre, descripciÃ³n, precio, stock, categorÃ­a e imagen. La conexiÃ³n a la base de datos se realiza mediante PDO, lo que mejora la seguridad respecto al cÃ³digo visto en clase. La base de datos ha sido ejecutada desde la consola y enlazada correctamente con la aplicaciÃ³n.

El catÃ¡logo de productos se muestra mediante tarjetas organizadas en una cuadrÃ­cula, en lugar de listados simples. Cada tarjeta incluye la imagen del producto, su categorÃ­a, el nombre, el precio y el stock disponible. AdemÃ¡s, he implementado un sistema de imagen por defecto para evitar errores en caso de que alguna imagen no exista.

Otra mejora importante es el carrito de la compra, que funciona mediante sesiones. Desde cada tarjeta se puede aÃ±adir productos al carrito, aumentar o disminuir la cantidad con botones de suma y resta y ver en todo momento cuÃ¡ntas unidades hay aÃ±adidas. Esto mejora mucho la usabilidad respecto al ejemplo bÃ¡sico visto en clase.

TambiÃ©n he aÃ±adido un buscador para filtrar productos y he mejorado la navegaciÃ³n entre las distintas pÃ¡ginas de la tienda, como el catÃ¡logo, la vista de producto y la confirmaciÃ³n de compra. A nivel visual, he aplicado un diseÃ±o con colores claros y tarjetas para que la tienda tenga un aspecto mÃ¡s similar a una tienda online real.

En conclusiÃ³n, respecto al cÃ³digo de clase, este proyecto mejora la organizaciÃ³n del cÃ³digo, el uso de la base de datos, la gestiÃ³n del carrito, el tratamiento de imÃ¡genes y el diseÃ±o visual, aplicando de forma prÃ¡ctica los conocimientos aprendidos durante la unidad.
