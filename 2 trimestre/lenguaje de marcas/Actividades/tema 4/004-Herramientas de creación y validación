Actividad: Creación y validación de documentos XML
Contexto
En este ejercicio práctico, aprenderás a crear un documento XML instanciado a partir de un esquema XSD utilizando Python. Este proceso te permitirá aplicar los conocimientos adquiridos sobre el manejo de lenguajes de marcas en sistemas de gestión de información.

Enunciado paso a paso
Carga del esquema XSD: Utiliza la biblioteca xml.etree.ElementTree para cargar el archivo esquema.xsd.
Recorrido del esquema: Identifica los elementos dentro del esquema que corresponden al tipo complejo de la persona y extrae sus nombres.
Entrada de datos por consola: Solicita al usuario valores para cada campo definido en el esquema.
Construcción del XML: Crea un elemento persona y añade a él subelementos con los valores proporcionados.
Formato del XML: Utiliza minidom para formatear el XML de salida, asegurándote de que sea legible.
Guardado del archivo: Guarda el XML formateado en un archivo llamado persona.xml.
Restricciones
Solo puedes usar las herramientas y bibliotecas mencionadas en la lista blanca.
No puedes utilizar librerías externas ni estructuras no vistas en esta unidad.
Criterios de evaluación
Introducción y contextualización (25%): El alumno debe explicar el contexto del ejercicio, cómo se relaciona con el tema impartido y por qué es importante.
Desarrollo técnico correcto y preciso (25%): El código debe ser correcto, seguir las mejores prácticas de programación y cumplir con los requisitos especificados.
Aplicación práctica con ejemplo claro (25%): El ejercicio debe ser aplicado correctamente, mostrando un ejemplo claro y detallado del proceso completo.
Cierre/Conclusión enlazando con la unidad (25%): El alumno debe cerrar el ejercicio explicando cómo los conocimientos adquiridos se pueden aplicar en situaciones reales y cómo estos conceptos son relevantes para la gestión de información.



Respuesta:

En este ejercicio he aprendido a crear un archivo XML a partir de un esquema XSD usando Python. He visto cómo se puede leer la estructura de un esquema, pedir datos al usuario y generar un XML que tenga todos los campos necesarios. Me ha servido para entender mejor cómo se organiza la información y cómo se puede guardar de forma que otros programas puedan usarla sin problemas.

Crearpersona.py:
```
import xml.etree.ElementTree as ET
from xml.dom import minidom
from datetime import datetime
import re

xsd_file = 'esquema.xsd'
tree = ET.parse(xsd_file)
root = tree.getroot()

ns = {'xs': 'http://www.w3.org/2001/XMLSchema'}

persona_elements = []
for elem in root.findall(".//xs:element[@name='persona']/xs:complexType/xs:sequence/xs:element", ns):
    persona_elements.append(elem.attrib['name'])

persona_data = {}
for field in persona_elements:
    while True:
        value = input(f"Ingrese {field}: ")
        if field == "fechaNacimiento":
            try:
                datetime.strptime(value, "%Y-%m-%d")
                break
            except ValueError:
                print("Error: la fecha debe estar en formato AAAA-MM-DD. Intente nuevamente.")
        elif field == "email":
            if re.match(r"[^@]+@[^@]+\.[^@]+", value):
                break
            else:
                print("Error: el email debe tener un formato valido (usuario@dominio.com).")
        else:
            break
    persona_data[field] = value

persona_xml = ET.Element('persona')
for field, value in persona_data.items():
    sub_elem = ET.SubElement(persona_xml, field)
    sub_elem.text = value

xml_str = ET.tostring(persona_xml, encoding='utf-8')
dom = minidom.parseString(xml_str)
pretty_xml = dom.toprettyxml(indent="  ")

with open('persona.xml', 'w', encoding='utf-8') as f:
    f.write(pretty_xml)

print("Archivo 'persona.xml' creado correctamente.")
```

esquema.xsd:
```
<?xml version="1.0" encoding="UTF-8"?>
<xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
           elementFormDefault="qualified">

    <xs:element name="persona">
        <xs:complexType>
            <xs:sequence>
                <xs:element name="nombre" type="xs:string"/>
                <xs:element name="apellidos" type="xs:string"/>
                <xs:element name="email" type="xs:string"/>
                <xs:element name="fechaNacimiento" type="xs:date"/>
                <xs:element name="direccion" type="xs:string"/>
                <xs:element name="codigopostal" type="xs:string"/>
            </xs:sequence>
        </xs:complexType>
    </xs:element>

</xs:schema>
```


Consola:

C:\Users\Serena\Documents\lenguaje de marcas\Actividades> python crearpersona.py
Ingrese nombre: Serena Sania
Ingrese apellidos: Sania Esteve
Ingrese email: serenaestvee@gmail.com
Ingrese fechaNacimiento: 05-06-2003
Error: la fecha debe estar en formato AAAA-MM-DD. Intente nuevamente.
Ingrese fechaNacimiento: 2003-06-05
Ingrese direccion: Calle Palleter 10
Ingrese codigopostal: 46920
Archivo 'persona.xml' creado correctamente.

C:\Users\Serena\Documents\lenguaje de marcas\Actividades>



persona.xml:
```
<persona>
<nombre>Serena Sania </nombre>
<apellidos>Sania Esteve</apellidos>
<email>serenaestvee@gmail.com</email>
<fechaNacimiento>2003-06-05</fechaNacimiento>
<direccion>Calle Palleter 10</direccion>
<codigopostal>46920</codigopostal>
</persona>
```

Con este ejercicio he entendido la importancia de los XML y los XSD para guardar y compartir información de manera organizada. También he practicado cómo usar Python para crear un archivo XML válido y legible. Ahora sé cómo aplicar estos conocimientos en otros ejercicios o proyectos donde necesite trabajar con datos estructurados.
